<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galerij - Sil Stook!</title>
    <!-- Logo als favicon - SVG ondersteuning -->
    <link rel="icon" type="image/svg+xml" href="https://lh3.googleusercontent.com/d/1FQPt_H-a1PNAfRAy1LA0graRtn5R34iN=s0">
    <!-- Fallback voor browsers zonder SVG favicon ondersteuning -->
    <link rel="icon" type="image/png" href="https://drive.google.com/thumbnail?id=1FQPt_H-a1PNAfRAy1LA0graRtn5R34iN&sz=w32">
    <!-- Apple touch icon -->
    <link rel="apple-touch-icon" href="https://drive.google.com/thumbnail?id=1FQPt_H-a1PNAfRAy1LA0graRtn5R34iN&sz=w180">
    <!-- Global CSS stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="header-container">
            <h1>
                <img src="https://drive.google.com/uc?export=view&id=1FFqyxfwtvYE9iqncYQkgXwOhnv2rewjE" 
                     alt="Sil Stook Logo" 
                     class="logo"
                     onload="console.log('‚úÖ Header logo loaded successfully')"
                     onerror="console.log('‚ùå Header logo failed, trying fallback'); this.src='https://drive.google.com/thumbnail?id=1FFqyxfwtvYE9iqncYQkgXwOhnv2rewjE&sz=w800'">
            </h1>
            
            <nav class="navigation">
                <a href="index.html" class="nav-button">Home</a>
                <a href="galerij.html" class="nav-button active">Galerij</a>
                <a href="contact.html" class="nav-button">Contact</a>
            </nav>
        </div>
    </header>
    
    <main>
        <section class="gallery">
            <h2>Galerij</h2>
            <p>Hier zijn enkele van mijn werken:</p>
            <div class="loading" id="loading">Bezig met laden van de galerij...</div>
            <div class="gallery-grid" id="gallery-grid"></div>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 Sil Stook. Alle rechten voorbehouden.</p>
    </footer>
    
    <!-- Lightbox voor full-size afbeelding weergave -->
    <div id="lightbox" class="lightbox">
        <!-- Controls buiten lightbox-content zodat ze niet mee transformeren -->
        <div class="lightbox-zoom-controls">
            <span class="lightbox-zoom-btn" id="zoom-out" title="Uitzoomen" onclick="zoomOut()">‚àí</span>
            <span class="lightbox-zoom-info" id="zoom-level">100%</span>
            <span class="lightbox-zoom-btn" id="zoom-in" title="Inzoomen" onclick="zoomIn()">+</span>
            <span class="lightbox-zoom-btn" id="zoom-reset" title="Reset zoom" onclick="resetZoom()">‚åÇ</span>
        </div>
        <span class="lightbox-close" id="lightbox-close">&times;</span>
        
        <div class="lightbox-content">
            <img id="lightbox-image" class="lightbox-image" src="" alt="">
        </div>
        
        <div class="lightbox-info" id="lightbox-info">
            <h3 id="lightbox-title"></h3>
            <p id="lightbox-description"></p>
            <p class="price" id="lightbox-price"></p>
        </div>
    </div>
    
    <script>
        // Functie om Google Drive URL om te zetten naar directe image URL - ultra robuuste versie
        function convertGoogleDriveUrl(url) {
            if (!url || typeof url !== 'string') return '';
            
            // Trim whitespace
            url = url.trim();
            
            console.log('Converting URL:', url);
            
            // Als het al een directe image URL is, gebruik die
            if (url.includes('drive.google.com/uc?') || 
                url.includes('googleusercontent.com') ||
                url.includes('drive.usercontent.google.com')) {
                console.log('URL is already direct, using as-is');
                return url;
            }
            
            // Alle mogelijke Google Drive file ID patronen
            const patterns = [
                // Patroon: /file/d/FILE_ID/view
                /\/file\/d\/([a-zA-Z0-9-_]+)\/view/,
                // Patroon: /d/FILE_ID/ (sharing links)
                /\/d\/([a-zA-Z0-9-_]+)/,
                // Patroon: id=FILE_ID
                /[?&]id=([a-zA-Z0-9-_]+)/,
                // Patroon: alleen de file ID (als backup)
                /([a-zA-Z0-9-_]{25,})/
            ];
            
            let fileId = null;
            
            // Probeer elk patroon tot we een file ID vinden
            for (let i = 0; i < patterns.length; i++) {
                const match = url.match(patterns[i]);
                if (match && match[1]) {
                    fileId = match[1];
                    console.log(`File ID found using pattern ${i + 1}:`, fileId);
                    break;
                }
            }
            
            // Als we een file ID hebben gevonden, converteer naar directe URL
            if (fileId && url.includes('drive.google.com')) {
                // Voor betere kwaliteit, gebruik view URL in plaats van download
                const directUrl = `https://drive.google.com/uc?export=view&id=${fileId}`;
                console.log('Converted to view URL for better quality:', directUrl);
                return directUrl;
            }
            
            // Als geen file ID gevonden, probeer andere cloud services
            if (url.includes('dropbox.com')) {
                // Dropbox direct link conversie
                const dropboxDirect = url.replace('dropbox.com', 'dl.dropboxusercontent.com').replace('?dl=0', '');
                console.log('Converted Dropbox URL:', dropboxDirect);
                return dropboxDirect;
            }
            
            if (url.includes('onedrive.live.com') || url.includes('1drv.ms')) {
                // OneDrive URLs blijven zoals ze zijn (meestal werken ze direct)
                console.log('OneDrive URL detected, using as-is');
                return url;
            }
            
            // Als het een andere URL is die op een afbeelding lijkt, probeer direct
            if (url.match(/\.(jpg|jpeg|png|gif|webp|bmp|svg)(\?.*)?$/i)) {
                console.log('Direct image URL detected');
                return url;
            }
            
            // Als laatste optie, return originele URL
            console.log('No conversion applied, using original URL');
            return url;
        }
        
        // Functie om CSV te parseren - verbeterde versie
        function parseCSV(csvText) {
            console.log('Raw CSV data:', csvText); // Debug
            
            const lines = csvText.trim().split('\n');
            if (lines.length < 2) {
                console.log('Not enough lines in CSV');
                return [];
            }
            
            // Verwijder mogelijke BOM en quotes
            const headers = lines[0].replace(/^\uFEFF/, '').split(',').map(h => h.trim().replace(/"/g, ''));
            console.log('Headers found:', headers); // Debug
            
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim() === '') continue; // Skip lege regels
                
                // Betere CSV parsing die rekening houdt met komma's in quotes
                const values = lines[i].match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g) || [];
                const row = {};
                
                headers.forEach((header, index) => {
                    if (values[index]) {
                        row[header] = values[index].trim().replace(/^"/, '').replace(/"$/, '');
                    } else {
                        row[header] = '';
                    }
                });
                
                console.log('Parsed row:', row); // Debug
                data.push(row);
            }
            
            return data;
        }
        
        // Functie om galerij item te maken - ultra robuuste versie met fallback systeem
        function createGalleryItem(item) {
            console.log('Creating gallery item for:', item);
            
            // Probeer verschillende veldnamen voor flexibiliteit
            const originalUrl = item['Image URL'] || 
                               item['image url'] || 
                               item['ImageURL'] || 
                               item['url'] || 
                               item['URL'] || 
                               item['Afbeelding'] ||
                               item['afbeelding'] ||
                               item['Link'] ||
                               item['link'] ||
                               '';
            
            const imageUrl = convertGoogleDriveUrl(originalUrl);
            
            const title = item['Titel'] || 
                         item['Title'] || 
                         item['titel'] || 
                         item['title'] || 
                         item['Naam'] ||
                         item['naam'] ||
                         item['Name'] ||
                         item['name'] ||
                         'Zonder titel';
            
            const description = item['Beschrijving'] || 
                               item['Description'] || 
                               item['beschrijving'] || 
                               item['description'] || 
                               item['Omschrijving'] ||
                               item['omschrijving'] ||
                               item['Details'] ||
                               item['details'] ||
                               '';
            
            const price = item['Prijs'] || 
                         item['Price'] || 
                         item['prijs'] || 
                         item['price'] || 
                         item['Kosten'] ||
                         item['kosten'] ||
                         item['Bedrag'] ||
                         item['bedrag'] ||
                         '';
            
            console.log('Final image URL for', title + ':', imageUrl);
            
            // Genereer unieke ID voor elke afbeelding voor fallback systeem
            const imageId = 'img_' + Math.random().toString(36).substr(2, 9);
            
            // Escape strings voor HTML attributes - verwijder quotes en vervang door safe characters
            const safeTitle = title.replace(/'/g, '').replace(/"/g, '').replace(/`/g, '');
            const safeDescription = description.replace(/'/g, '').replace(/"/g, '').replace(/`/g, '');
            const safePrice = price.replace(/'/g, '').replace(/"/g, '').replace(/`/g, '');
            
            return `
                <div class="gallery-item">
                    <img id="${imageId}" 
                         src="${imageUrl}" 
                         alt="${safeTitle}" 
                         onclick="openLightbox(this.src, '${safeTitle}', '${safeDescription}', '${safePrice}')"
                         onload="console.log('‚úÖ Image loaded successfully:', '${title}')"
                         onerror="handleImageError('${imageId}', '${originalUrl}', '${title}')">
                    <div class="gallery-item-content">
                        <h3>${title}</h3>
                        <p>${description}</p>
                        <p class="price">${price}</p>
                    </div>
                </div>
            `;
        }
        
        // Functie voor robuuste afbeelding foutafhandeling met fallback systeem
        function handleImageError(imageId, originalUrl, title) {
            console.error('‚ùå Image failed to load:', title, 'Original URL:', originalUrl);
            
            const imgElement = document.getElementById(imageId);
            if (!imgElement) return;
            
            // Probeer verschillende fallback methodes
            const fallbackUrls = [];
            
            // Als het een Google Drive URL is, probeer verschillende formaten
            if (originalUrl.includes('drive.google.com')) {
                const fileIdMatch = originalUrl.match(/([a-zA-Z0-9-_]{25,})/);
                if (fileIdMatch) {
                    const fileId = fileIdMatch[1];
                    fallbackUrls.push(
                        `https://drive.google.com/uc?export=download&id=${fileId}`,
                        `https://drive.google.com/thumbnail?id=${fileId}&sz=w400`,
                        `https://lh3.googleusercontent.com/d/${fileId}`,
                        `https://drive.google.com/file/d/${fileId}/preview`
                    );
                }
            }
            
            // Voeg originele URL toe als fallback
            if (originalUrl && !fallbackUrls.includes(originalUrl)) {
                fallbackUrls.push(originalUrl);
            }
            
            // Probeer elke fallback URL
            let currentFallback = 0;
            
            const tryNextFallback = () => {
                if (currentFallback < fallbackUrls.length) {
                    const fallbackUrl = fallbackUrls[currentFallback];
                    console.log(`üîÑ Trying fallback ${currentFallback + 1}:`, fallbackUrl);
                    
                    imgElement.onerror = () => {
                        currentFallback++;
                        tryNextFallback();
                    };
                    
                    imgElement.onload = () => {
                        console.log('‚úÖ Fallback successful:', fallbackUrl);
                    };
                    
                    imgElement.src = fallbackUrl;
                } else {
                    // Alle fallbacks gefaald, toon placeholder
                    console.log('‚ùå All fallbacks failed, showing placeholder');
                    imgElement.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2Y4ZjlmYSIgc3Ryb2tlPSIjZGRkIiBzdHJva2Utd2lkdGg9IjIiLz48dGV4dCB4PSI1MCUiIHk9IjQ1JSIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0iIzY2NiIgZm9udC1zaXplPSIxNHB4Ij5BZmJlZWxkaW5nPC90ZXh0Pjx0ZXh0IHg9IjUwJSIgeT0iNjAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjY2IiBmb250LXNpemU9IjE0cHgiPm5pZXQgYmVzY2hpa2JhYXI8L3RleHQ+PC9zdmc+';
                    imgElement.onerror = null; // Stop verdere error handling
                }
            };
            
            tryNextFallback();
        }
        
        // Hoofdfunctie om CSV data te laden - eenvoudige versie
        async function loadGallery() {
            const loading = document.getElementById('loading');
            const galleryGrid = document.getElementById('gallery-grid');
            
            loading.textContent = 'Bezig met laden van de galerij...';
            loading.style.display = 'block';
            
            try {
                // Voeg timestamp toe om cache te voorkomen
                const timestamp = new Date().getTime();
                const csvUrl = `https://docs.google.com/spreadsheets/d/e/2PACX-1vRr4D_i1bEqe6shBt6ZlKnYacUne-1csFmyQwYfeFRQ-NsjbbBCH2JQgM47d8Ro9tr6mu-7bbs12VMF/pub?output=csv&t=${timestamp}`;
                
                console.log('Trying to fetch CSV from:', csvUrl);
                
                // Gebruik CORS proxy
                const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(csvUrl);
                
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                console.log('CSV Text received:', csvText.substring(0, 200) + '...');
                
                const galleryData = parseCSV(csvText);
                console.log('Parsed gallery data:', galleryData);
                
                if (galleryData.length > 0) {
                    galleryGrid.innerHTML = galleryData.map(createGalleryItem).join('');
                    loading.style.display = 'none';
                    console.log('Gallery loaded successfully with', galleryData.length, 'items');
                } else {
                    loading.textContent = 'Geen galerij items gevonden in de CSV data.';
                    console.log('No gallery items found');
                }
                
            } catch (error) {
                console.error('Fout bij het laden van de galerij:', error);
                loading.textContent = `Fout bij het laden van de galerij: ${error.message}. Controleer de browser console voor meer details.`;
            }
        }
        
        // Lightbox functionaliteit voor full-size afbeelding weergave - verbeterde versie met zoom
        function openLightbox(imageSrc, title, description, price) {
            console.log('üñºÔ∏è Opening lightbox with:', {
                imageSrc: imageSrc,
                title: title,
                description: description,
                price: price
            });
            
            const lightbox = document.getElementById('lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const lightboxTitle = document.getElementById('lightbox-title');
            const lightboxDescription = document.getElementById('lightbox-description');
            const lightboxPrice = document.getElementById('lightbox-price');
            
            if (!lightbox || !lightboxImage) {
                console.error('‚ùå Lightbox elements not found!');
                return;
            }
            
            // Reset zoom en positionering
            resetZoom();
            
            // Reset de lightbox image eerst
            lightboxImage.src = '';
            lightboxImage.style.display = 'none';
            
            // Stel de info in
            lightboxTitle.textContent = title || 'Zonder titel';
            lightboxDescription.textContent = description || '';
            lightboxPrice.textContent = price || '';
            
            // Toon de lightbox
            lightbox.classList.add('active');
            
            // Voorkom scrolling van de achtergrond
            document.body.style.overflow = 'hidden';
            
            // Laad de afbeelding met foutafhandeling
            lightboxImage.onload = function() {
                console.log('‚úÖ Lightbox image loaded successfully');
                lightboxImage.style.display = 'block';
                initializeZoom(); // Start zoom functionaliteit
            };
            
            lightboxImage.onerror = function() {
                console.error('‚ùå Lightbox image failed to load:', imageSrc);
                // Probeer fallback URL's voor lightbox
                tryLightboxFallbacks(imageSrc, title);
            };
            
            // Stel de afbeelding in (dit moet laatste zijn)
            lightboxImage.src = imageSrc;
            lightboxImage.alt = title || 'Afbeelding';
            
            console.log('üñºÔ∏è Lightbox opened for:', title);
        }
        
        // Fallback systeem specifiek voor lightbox afbeeldingen
        function tryLightboxFallbacks(originalSrc, title) {
            console.log('üîÑ Trying lightbox fallbacks for:', originalSrc);
            
            const lightboxImage = document.getElementById('lightbox-image');
            if (!lightboxImage) return;
            
            const fallbackUrls = [];
            
            // Als het een Google Drive URL is, probeer verschillende formaten
            if (originalSrc.includes('drive.google.com')) {
                const fileIdMatch = originalSrc.match(/([a-zA-Z0-9-_]{25,})/);
                if (fileIdMatch) {
                    const fileId = fileIdMatch[1];
                    fallbackUrls.push(
                        `https://drive.google.com/uc?export=download&id=${fileId}`,
                        `https://lh3.googleusercontent.com/d/${fileId}=w1000`,
                        `https://drive.google.com/thumbnail?id=${fileId}&sz=w800`,
                        `https://drive.google.com/file/d/${fileId}/preview`
                    );
                }
            }
            
            let currentFallback = 0;
            
            const tryNext = () => {
                if (currentFallback < fallbackUrls.length) {
                    const fallbackUrl = fallbackUrls[currentFallback];
                    console.log(`üîÑ Trying lightbox fallback ${currentFallback + 1}:`, fallbackUrl);
                    
                    lightboxImage.onload = () => {
                        console.log('‚úÖ Lightbox fallback successful:', fallbackUrl);
                        lightboxImage.style.display = 'block';
                    };
                    
                    lightboxImage.onerror = () => {
                        currentFallback++;
                        tryNext();
                    };
                    
                    lightboxImage.src = fallbackUrl;
                } else {
                    console.log('‚ùå All lightbox fallbacks failed, showing error message');
                    lightboxImage.style.display = 'none';
                    // Toon een foutmelding in de lightbox
                    const lightboxInfo = document.getElementById('lightbox-info');
                    if (lightboxInfo) {
                        lightboxInfo.innerHTML = `
                            <h3>${title || 'Afbeelding'}</h3>
                            <p style="color: #ff6b6b;">Afbeelding kon niet worden geladen</p>
                            <p style="font-size: 0.9em; opacity: 0.7;">Probeer later opnieuw</p>
                        `;
                    }
                }
            };
            
            tryNext();
        }
        
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            
            // Reset zoom wanneer lightbox wordt gesloten
            resetZoom();
            
            // Herstel scrolling
            document.body.style.overflow = 'auto';
            
            console.log('‚ùå Lightbox closed');
        }
        
        // Zoom functionaliteit variabelen
        let currentZoom = 1;
        let minZoom = 0.5;
        let maxZoom = 5;
        let isDragging = false;
        let startX, startY, initialX, initialY;
        let panSensitivity = 0.6; // Verminder gevoeligheid voor panning (0.6 = 60% van originele beweging)
        
        // Zoom functionaliteit - verbeterde versie zonder conflicten
        function initializeZoom() {
            const lightboxImage = document.getElementById('lightbox-image');
            const lightbox = document.getElementById('lightbox');
            
            // Mouse wheel zoom
            lightbox.addEventListener('wheel', handleZoom);
            
            // Touch zoom (pinch-to-zoom) - verbeterde versie
            let lastTouchDistance = 0;
            let isZooming = false;
            
            lightbox.addEventListener('touchstart', function(e) {
                if (e.touches.length === 2) {
                    // Pinch-to-zoom start
                    e.preventDefault();
                    isZooming = true;
                    lastTouchDistance = getTouchDistance(e.touches[0], e.touches[1]);
                    console.log('ü§è Pinch-to-zoom started');
                } else if (e.touches.length === 1 && currentZoom > 1) {
                    // Pan start - alleen als er al gezoomd is
                    isDragging = true;
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                    const transform = lightboxImage.style.transform;
                    const translate = transform.match(/translate\(([^,]+),([^)]+)\)/);
                    initialX = translate ? parseFloat(translate[1]) : 0;
                    initialY = translate ? parseFloat(translate[2]) : 0;
                }
            });
            
            lightbox.addEventListener('touchmove', function(e) {
                if (e.touches.length === 2 && isZooming) {
                    // Pinch-to-zoom
                    e.preventDefault();
                    e.stopPropagation();
                    const newDistance = getTouchDistance(e.touches[0], e.touches[1]);
                    const zoomChange = newDistance / lastTouchDistance;
                    const newZoom = Math.max(minZoom, Math.min(maxZoom, currentZoom * zoomChange));
                    setZoom(newZoom);
                    lastTouchDistance = newDistance;
                } else if (isDragging && e.touches.length === 1 && currentZoom > 1) {
                    // Pan - alleen bij single touch en zoom > 1, met verminderde gevoeligheid
                    e.preventDefault();
                    const deltaX = (e.touches[0].clientX - startX) * panSensitivity;
                    const deltaY = (e.touches[0].clientY - startY) * panSensitivity;
                    const newX = initialX + deltaX;
                    const newY = initialY + deltaY;
                    lightboxImage.style.transform = `scale(${currentZoom}) translate(${newX}px, ${newY}px)`;
                }
            });
            
            lightbox.addEventListener('touchend', function(e) {
                if (e.touches.length < 2) {
                    isZooming = false;
                    lastTouchDistance = 0;
                }
                if (e.touches.length === 0) {
                    isDragging = false;
                }
            });
            
            // Mouse drag voor panning
            lightboxImage.addEventListener('mousedown', function(e) {
                if (currentZoom > 1) {
                    isDragging = true;
                    startX = e.clientX;
                    startY = e.clientY;
                    const transform = lightboxImage.style.transform;
                    const translate = transform.match(/translate\(([^,]+),([^)]+)\)/);
                    initialX = translate ? parseFloat(translate[1]) : 0;
                    initialY = translate ? parseFloat(translate[2]) : 0;
                    e.preventDefault();
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isDragging && currentZoom > 1) {
                    // Mouse drag met verminderde gevoeligheid
                    const deltaX = (e.clientX - startX) * panSensitivity;
                    const deltaY = (e.clientY - startY) * panSensitivity;
                    const newX = initialX + deltaX;
                    const newY = initialY + deltaY;
                    lightboxImage.style.transform = `scale(${currentZoom}) translate(${newX}px, ${newY}px)`;
                }
            });
            
            document.addEventListener('mouseup', function() {
                isDragging = false;
            });
        }
        
        function handleZoom(e) {
            e.preventDefault();
            const zoomChange = e.deltaY > 0 ? 0.9 : 1.1;
            const newZoom = Math.max(minZoom, Math.min(maxZoom, currentZoom * zoomChange));
            setZoom(newZoom);
        }
        
        function setZoom(zoom) {
            currentZoom = zoom;
            const lightboxImage = document.getElementById('lightbox-image');
            const zoomLevel = document.getElementById('zoom-level');
            
            // Update transform (behoud huidige translate als die er is)
            const currentTransform = lightboxImage.style.transform;
            const translate = currentTransform.match(/translate\(([^)]+)\)/);
            const translatePart = translate ? ` translate(${translate[1]})` : '';
            
            lightboxImage.style.transform = `scale(${zoom})${translatePart}`;
            
            // Update zoom level display
            zoomLevel.textContent = Math.round(zoom * 100) + '%';
            
            // Update cursor
            if (zoom > 1) {
                lightboxImage.classList.add('zoomed');
            } else {
                lightboxImage.classList.remove('zoomed');
            }
            
            console.log('üîç Zoom set to:', Math.round(zoom * 100) + '%');
        }
        
        function zoomIn() {
            const newZoom = Math.min(maxZoom, currentZoom * 1.2);
            setZoom(newZoom);
        }
        
        function zoomOut() {
            const newZoom = Math.max(minZoom, currentZoom / 1.2);
            setZoom(newZoom);
        }
        
        function resetZoom() {
            currentZoom = 1;
            const lightboxImage = document.getElementById('lightbox-image');
            const zoomLevel = document.getElementById('zoom-level');
            
            if (lightboxImage) {
                lightboxImage.style.transform = 'scale(1)';
                lightboxImage.classList.remove('zoomed');
            }
            
            if (zoomLevel) {
                zoomLevel.textContent = '100%';
            }
            
            console.log('üîÑ Zoom reset to 100%');
        }
        
        function getTouchDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        // Event listeners voor lightbox
        document.addEventListener('DOMContentLoaded', function() {
            const lightbox = document.getElementById('lightbox');
            const lightboxClose = document.getElementById('lightbox-close');
            const lightboxContent = document.querySelector('.lightbox-content');
            
            // Sluit lightbox bij klik op close button
            lightboxClose.addEventListener('click', closeLightbox);
            
            // Sluit lightbox bij klik op achtergrond (niet op de afbeelding)
            lightbox.addEventListener('click', function(e) {
                if (e.target === lightbox) {
                    closeLightbox();
                }
            });
            
            // Voorkom dat klik op lightbox content de lightbox sluit
            lightboxContent.addEventListener('click', function(e) {
                e.stopPropagation();
            });
            
            // Sluit lightbox met Escape toets
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && lightbox.classList.contains('active')) {
                    closeLightbox();
                }
            });
            
            // Touch events voor mobiele apparaten - verbeterde versie
            let touchStartY = 0;
            let touchEndY = 0;
            let touchCount = 0;
            let isPinching = false;
            
            lightbox.addEventListener('touchstart', function(e) {
                touchCount = e.touches.length;
                
                // Alleen track single touch voor swipe-to-close
                if (touchCount === 1) {
                    touchStartY = e.changedTouches[0].screenY;
                    isPinching = false;
                } else if (touchCount === 2) {
                    // Multi-touch detecteren (pinch)
                    isPinching = true;
                }
            });
            
            lightbox.addEventListener('touchmove', function(e) {
                // Update pinching status
                if (e.touches.length >= 2) {
                    isPinching = true;
                }
            });
            
            lightbox.addEventListener('touchend', function(e) {
                // Alleen swipe-to-close bij single touch en geen pinching
                if (touchCount === 1 && !isPinching && e.changedTouches.length === 1) {
                    touchEndY = e.changedTouches[0].screenY;
                    
                    // Als er een significante swipe omhoog of omlaag is EN geen zoom actief
                    const swipeDistance = Math.abs(touchEndY - touchStartY);
                    if (swipeDistance > 150 && currentZoom <= 1.1) {
                        console.log('üîÑ Swipe-to-close detected');
                        closeLightbox();
                    }
                }
                
                // Reset tracking variabelen
                setTimeout(() => {
                    isPinching = false;
                    touchCount = 0;
                }, 100);
            });
            
            // Laad de galerij
            loadGallery();
        });
    </script>
</body>
</html>
